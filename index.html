<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gestão MPE — Protótipo</title>
  <meta name="description" content="Protótipo mobile-first de gestão empresarial para micro e pequenas empresas." />
  <link rel="stylesheet" href="./assets/styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="logo">GM</span>
      <div class="brand-text">
        <div class="brand-name">Gestão MPE</div>
        <div class="brand-sub">v0.4 • offline</div>
      </div>
    </div>

    <button class="icon-btn" id="btnTheme" title="Alternar tema" aria-label="Alternar tema">
      <span class="icon">☀︎</span>
    </button>
  </header>

  <main class="container">
    <section class="card hero">
      <div>
        <h1>Visão rápida</h1>
        <p class="muted">Cadastre entradas e saídas por conta e centro de custo, acompanhe o saldo e gere relatórios com gráficos.</p>
      </div>

      <div class="kpis">
        <div class="kpi">
          <div class="kpi-label">Saldo geral</div>
          <div class="kpi-value" id="kpiBalance">R$ 0,00</div>
        </div>
        <div class="kpi">
          <div class="kpi-label">Entradas (mês)</div>
          <div class="kpi-value" id="kpiIncome">R$ 0,00</div>
        </div>
        <div class="kpi">
          <div class="kpi-label">Saídas (mês)</div>
          <div class="kpi-value" id="kpiExpense">R$ 0,00</div>
        </div>
      </div>
    </section>

    <nav class="tabs" aria-label="Navegação">
      <button class="tab active" data-view="lancamentos">Lançamentos</button>
      <button class="tab" data-view="relatorios">Relatórios</button>
      <button class="tab" data-view="projecoes">Projeções</button>
      <button class="tab" data-view="config">Config</button>
    </nav>

    <!-- Lançamentos -->
    <section class="view" id="view-lancamentos">

      <!-- Contas e Centro de Custo -->
      <div class="card">
        <div class="row space">
          <h2>Contas e Centros de custo</h2>
          <div class="actions">
            <button class="btn" id="btnAddAccount">+ Conta</button>
            <button class="btn" id="btnAddCostCenter">+ Centro de custo</button>
          </div>
        </div>

        <div class="grid-2" id="accountsPanel"></div>
      </div>

      <div class="card">
        <h2>Novo lançamento</h2>
        <form id="txForm" class="form">
          <div class="grid">
            <label class="field">
              <span>Tipo</span>
              <select id="txType" required>
                <option value="income">Entrada</option>
                <option value="expense">Saída</option>
              </select>
            </label>

            <label class="field">
              <span>Data</span>
              <input id="txDate" type="date" required />
            </label>

            <label class="field">
              <span>Valor</span>
              <input id="txAmount" type="number" step="0.01" min="0" placeholder="0,00" required />
            </label>

            <label class="field">
              <span>Categoria</span>
              <input id="txCategory" type="text" placeholder="Ex: Vendas, Aluguel, Marketing" required />
            </label>

            <label class="field">
              <span>Conta</span>
              <select id="txAccount" required></select>
            </label>

            <label class="field">
              <span>Centro de custo</span>
              <select id="txCostCenter" required></select>
            </label>
          </div>

          <label class="field">
            <span>Descrição (opcional)</span>
            <input id="txNote" type="text" placeholder="Detalhes do lançamento" />
          </label>

          <div class="actions">
            <button type="submit" class="btn primary">Salvar</button>
            <button type="button" class="btn" id="btnSeed">Criar dados de exemplo</button>
            <button type="button" class="btn danger" id="btnWipe">Limpar tudo</button>
          </div>
        </form>
      </div>

      <div class="card">
        <div class="row space">
          <h2>Movimentações</h2>
          <div class="filters">
            <select id="filterMonth" aria-label="Filtrar por mês"></select>
            <select id="filterType" aria-label="Filtrar por tipo">
              <option value="all">Tudo</option>
              <option value="income">Entradas</option>
              <option value="expense">Saídas</option>
            </select>
            <select id="filterAccount" aria-label="Filtrar por conta"></select>
            <select id="filterCostCenter" aria-label="Filtrar por centro de custo"></select>
          </div>
        </div>

        <div class="table-wrap">
          <table class="table" aria-label="Lista de lançamentos">
            <thead>
              <tr>
                <th>Data</th>
                <th>Tipo</th>
                <th>Conta</th>
                <th>Centro</th>
                <th>Categoria</th>
                <th class="right">Valor</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="txTable"></tbody>
          </table>
        </div>

        <p class="muted small" id="txHint"></p>
      </div>
    </section>

    <!-- Relatórios -->
    <section class="view hidden" id="view-relatorios">
      <div class="card">
        <div class="row space">
          <h2>Relatórios</h2>
          <div class="actions">
            <button class="btn primary" id="btnExportCsvAll">Exportar CSV (Tudo)</button>
            <button class="btn" id="btnExportCsvFiltered">Exportar CSV (Filtrado)</button>
          </div>
        </div>

        <div class="grid-2">
          <div class="panel">
            <h3>Resumo do mês</h3>
            <div class="mini" id="reportMonthSummary"></div>
          </div>

          <div class="panel">
            <h3>Top 5 gastos (mês)</h3>
            <div class="mini" id="reportTopExpenses"></div>
          </div>

          <div class="panel">
            <h3>Por categoria (saldo no mês)</h3>
            <div class="mini" id="reportByCategory"></div>
          </div>

          <div class="panel">
            <h3>Por conta (saldo no mês)</h3>
            <div class="mini" id="reportByAccount"></div>
          </div>

          <div class="panel">
            <h3>Por centro de custo (saldo no mês)</h3>
            <div class="mini" id="reportByCostCenter"></div>
          </div>

          <div class="panel">
            <h3>Gráfico: Saídas por categoria</h3>
            <canvas id="chartPie" width="520" height="320" aria-label="Gráfico de pizza"></canvas>
            <div class="muted small" id="chartPieLegend"></div>
          </div>

          <div class="panel">
            <h3>Gráfico: Saldo por conta</h3>
            <canvas id="chartBars" width="520" height="320" aria-label="Gráfico de barras"></canvas>
            <div class="muted small">Escala automática. Valores incluem saldo inicial + lançamentos.</div>
          </div>
        </div>

        <p class="muted small">Dica: os relatórios usam o <strong>mês selecionado</strong> nos filtros da tela de Lançamentos.</p>
      </div>
    </section>

    <!-- Projeções -->
    <section class="view hidden" id="view-projecoes">
      <div class="card">
        <h2>Projeções (MVP)</h2>
        <p class="muted">Sugestões simples baseadas nos dados do mês selecionado.</p>

        <div class="grid-2">
          <div class="panel">
            <h3>Reserva recomendada</h3>
            <p class="muted small">Regra simples: <strong>1 a 3 meses</strong> do custo médio (saídas).</p>
            <div class="mini" id="projReserve"></div>
          </div>

          <div class="panel">
            <h3>Meta de saldo</h3>
            <p class="muted small">Proposta: manter saldo > <strong>30 dias</strong> de saídas médias.</p>
            <div class="mini" id="projTarget"></div>
          </div>
        </div>

        <div class="panel">
          <h3>Sugestões automáticas (rascunho)</h3>
          <ul class="list" id="projTips"></ul>
        </div>
      </div>
    </section>

    <!-- Config -->
    <section class="view hidden" id="view-config">
      <div class="card">
        <h2>Configurações</h2>

        <div class="grid">
          <label class="field">
            <span>Nome da empresa</span>
            <input id="cfgCompany" type="text" placeholder="Minha Empresa LTDA" />
          </label>

          <label class="field">
            <span>Moeda</span>
            <select id="cfgCurrency">
              <option value="BRL">BRL (R$)</option>
              <option value="USD">USD ($)</option>
              <option value="EUR">EUR (€)</option>
            </select>
          </label>
        </div>

        <div class="actions">
          <button class="btn primary" id="btnSaveCfg">Salvar</button>
        </div>

        <div class="panel">
          <h3>Backup e restauração</h3>
          <p class="muted small">Exporta/Importa tudo (configurações + lançamentos) em JSON.</p>
          <div class="actions">
            <button class="btn primary" id="btnExportJson">Exportar JSON</button>
            <label class="btn filelike">
              Importar JSON
              <input id="fileImportJson" type="file" accept="application/json" />
            </label>
          </div>
          <p class="muted small" id="backupHint"></p>
        </div>

        <details class="details">
          <summary>Roadmap (próximas etapas)</summary>
          <ul class="list">
            <li>Importação CSV e categorização automática.</li>
            <li>Relatório anual + tendências por mês.</li>
            <li>Multiusuário e sincronização (quando houver backend).</li>
          </ul>
        </details>
      </div>
    </section>

    <footer class="footer">
      <span class="muted small">v0.4 • Mobile-first • GitHub Pages</span>
    </footer>
  </main>

  <script src="./assets/app.js"></script>
</body>
</html>
